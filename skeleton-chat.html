<!--
@license
Copyright (c) 2018 FabricElements. All rights reserved.

@group Skeleton Chat
@demo demo/index.html
-->
<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="./chat-mixin/chat-mixin.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../app-route/app-location.html">
<link rel="import" href="../app-route/app-route.html">
<link rel="import" href="./skeleton-chat-groups/skeleton-chat-groups.html">
<link rel="import" href="./skeleton-chat-box/skeleton-chat-box.html">

<dom-module id="skeleton-chat">
  <template>
    <style>
      :host {
        display: block;
        position: relative;
        height: 100%;
        overflow: hidden;
        @apply --layout-fit;
      }

      skeleton-chat-box {
        z-index: 100;
        transition: all ease-in-out 300ms;
        transform: translateY(120%);
        top: 100%;
      }

      skeleton-chat-box[opened] {
        transform: translateY(0);
        height: 100%;
        top: 0;
      }
    </style>
    <app-location route="{{route}}"></app-location>
    <app-route route="{{route}}"
               pattern="/chat"
               tail="{{chatRouteTail}}"></app-route>
    <app-route route="{{chatRouteTail}}"
               pattern="/:id"
               active="{{chatBoxActive}}"
               data="{{subrouteData}}"></app-route>
    <skeleton-chat-groups></skeleton-chat-groups>
    <skeleton-chat-box fullbleed
                       group$="[[subrouteData.id]]"
                       opened$="[[chatBoxActive]]"></skeleton-chat-box>
  </template>

  <script>
    /**
     * `skeleton-chat`
     *
     *
     * @customElement
     * @polymer
     * @appliesMixin Fabric.ChatMixin
     * @demo demo/index.html
     */
    class SkeletonChat extends Fabric.ChatMixin(Polymer.Element) {
      /**
       * @return {string}
       */
      static get is() {
        return 'skeleton-chat';
      }

      /**
       * @return {object}
       */
      static get properties() {
        return {
          /** Route */
          route: {
            type: Object,
          },
          /** Route data */
          routeData: {
            type: Object,
            value: {
              page: null,
            },
          },
          subrouteData: {
            type: Object,
            value: {
              id: null,
            },
          },
          chatBoxActive: {
            type: Boolean,
            value: false,
            notify: true,
          },
        };
      }
    }

    window.customElements.define(SkeletonChat.is, SkeletonChat);
  </script>
</dom-module>
